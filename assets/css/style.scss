$table-border-colour: #d5d5d5;
$table-header-background: linear-gradient(#eee 0%, #ccc 100%);

$dragbar-color: #b38b0d;

// 3d-effect borders, drag handles
$th-border-right: #bbb;
$th-border-left: #fff;

$progress-border-color: #bbb;
$progress-fill-color: #8d8;

$white: #fff;

$header-height: 40px;
$footer-height: 200px;
$torrents-height: calc(100vh - #{$footer-height} - #{$header-height});


@mixin unselectable {
  -webkit-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.context-menu {
  z-index: 1000;
  border: 1px solid #ddd;
  border-radius: 5px;
  box-shadow: 0 0 15px 5px #aaa;
  background: #f3f3f3;
}

.dragbar {
  display: none;
  position: absolute;
  top: 0;
  bottom: 0;
  z-index: 5;
  border-left: 1px solid $dragbar-color;
  width: 1px;

  &.visible {
    display: block;
  }
}

html {
  box-sizing: border-box;
}

*,
*::before,
*::after {
  box-sizing: inherit;
}

body {
  margin: 0;
  overflow: hidden;
  font-family: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen-Sans,Ubuntu,Cantarell,sans-serif;
  font-size: 11px;
}

.text-right {
  text-align: right;
}

.resizing-x {
  cursor: col-resize;

  // bodge to override cursor: default when resizing
  th {
    cursor: col-resize;
  }
}

.window {
  display: none;
  position: absolute;
  z-index: 1000;
  margin: 40px;
  border: 1px solid #ddd;
  border-radius: 5px;
  box-shadow: 0 0 15px 10px #888;
  background: #f2f2f2;
  padding: 35px 5px 5px;
  overflow-y: auto;

  // works great in Firefox, not so much Safari.
  // TODO: get updated coords to elm..
  // https://stackoverflow.com/questions/6492683/how-to-detect-divs-dimension-changed
  resize: both;
  min-width: 200px;
  min-height: 200px;


  &.visible {
    display: block;
  }

  .titlebar {
    display: flex;
    position: absolute;
    top: 0;
    left: 0;
    align-items: center;
    border-bottom: 1px solid #999;
    background: $table-header-background;
    width: 100%;
    height: 30px;
    font-size: 1.3em;

    .close-icon {
      margin: 10px;
      color: #a00;

      &:hover {
        color: #f00;
      }
    }
  }
}

.navigation {
  display: flex;
  justify-content: space-between;
  border-bottom: 1px solid $table-border-colour;
  background: #eee;
  padding: 5px;
  height: $header-height;

  .flex-container {
    // temporary home for buttons on left/right
    display: flex;
  }

  .name-filter {
    margin-right: 10px;
  }

  .hamburger-button {
    display: flex;
    position: relative;
  }
}

.messages {
  position: absolute;
  top: $header-height - 10px; // 10px margin on first li
  right: 5px;
  z-index: 5;

  li {
    position: relative;
    margin: 10px 0;
    border-radius: 5px;
    padding: 10px;
    list-style: none;
  }
}

.hamburger-menu {
  @include unselectable;

  position: absolute;
  top: 0;
  right: 0;
  z-index: 1000;
  border: 1px outset #555;
  background: #fff;
  color: #555;
  font-size: 1.1em;

  ul {
    white-space: nowrap;
    list-style: none;
    padding: 0;
    margin: 0;

    i {
      width: 30px;
    }

    li {
      cursor: default;
      padding: 10px 20px;

      &:hover {
        color: white;
        background: #6af;
      }
    }

  }
}

.preferences {
  width: 400px;
  height: 600px;
}

.logs {
  width: calc(100% - 80px);
  height: 600px;

  ol {
    padding: 0;

    li {
      display: flex;
      margin: 10px;
      background-color: #fafaaf;
      padding: 10px;
      list-style: none;
    }
  }

  .content {
    margin-left: 20px;
  }
}

.messages,
.logs {
  .error {
    border: 1px solid #ecc;
    background: #fdd;
    color: #811;
  }

  .warning {
    border: 1px solid #ec9;
    background: #fda;
    color: #761;
  }

  .info {
    border: 1px solid #cdc;
    background: #ded;
    color: #484;
  }
}

.torrents {
  height: $torrents-height;
  overflow: auto;

  &.loading {
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 10rem;
  }
}

.footer {
  display: flex;
  position: relative;
  align-items: stretch;
  justify-content: space-between;
  border-top: 1px solid $table-border-colour;
  background: #eee;
  padding: 5px;
  width: 100%;
  height: $footer-height;
}

.speed-chart {
  border: 1px solid #888;
  background: #fff;
  // 2.4 is ratio of chart when expanded, which is determined by coordinates
  // 1000x400 in SpeedChart.elm though this is plot area only. Margins and axes
  // etc end up making it around 1132x474 = 2.388
  //
  // width must be set, height auto-calculated. Remove some footer-height
  // to account for padding and borders etc. It's close enough tbh. If it's too wide
  // then content disappears off the bottom of the chart.
  width: ($footer-height - 13px) * 2.4;

  &:hover {
    position: absolute;
    right: 5px;
    bottom: 5px;
    width: 90%;
    height: auto;
  }
}

.torrent-status {
  font-size: .5rem;

  &.seeding {
    color: #181;
  }

  &.errored {
    color: #911;
  }

  &.downloading {
    color: #38e;
  }

  &.paused {
    color: #d80;
  }

  &.stopped {
    color: #ccc;
  }

  // hashing
  &.hashing {
    color: #777;
  }
}

.progress-container {
  position: relative;

  progress {
    border: 1px solid $progress-border-color;
    background-color: inherit;
    width: 100%;
    height: 16px;
    vertical-align: middle;
    color: $progress-fill-color;

    -webkit-appearance: none;
    appearance: none;

    &::-webkit-progress-bar {
      background-color: inherit;
    }

    &::-moz-progress-bar {
      background-color: $progress-fill-color;
    }

    &::-webkit-progress-value {
      background-color: $progress-fill-color;
    }
  }

  span {
    display: flex;
    position: absolute;
    top: 0;
    left: 0;
    align-items: center;
    justify-content: center;
    width: 100%;
    height: 100%;
    font-size: smaller;
  }
}

table {
  position: relative;
  border-spacing: 0;

  &.fixed {
    table-layout: fixed;
  }

  &.fluid {
    width: 100%;
  }
}

thead {
  @include unselectable;

  position: sticky; // don't scroll off top
  top: 0;
  z-index: 1; // stop progress-bars overlaying headers
}

th {
  position: relative; // so the dragbar can anchor to the right

  border-right: 1px solid $th-border-right;
  border-bottom: 1px solid $table-border-colour;
  border-left: 1px solid $th-border-left;

  background: $table-header-background;

  cursor: default;

  // changing this 4px l/r padding requires a change in elm.
  // see TorrentTable widthAttribute methods
  padding: 0 4px;

  text-align: left;

  &:first-child {
    border-left: 0;
  }

  &:last-child {
    border-right: 0;
  }

  &.sorted {
    &.descending {
      background: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='100' height='50' style='fill:none;stroke:currentColor;stroke-width:5'><polygon points='0,0 100,0 50,50'/></svg>") calc(100% - 2px) center / 10px no-repeat, $table-header-background;
    }

    &.ascending {
      background: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='100' height='50' style='fill:none;stroke:currentColor;stroke-width:5'><polygon points='50,0 0,50 100,50'/></svg>") calc(100% - 2px) center / 10px no-repeat, $table-header-background;
    }
  }

  .content {
    padding: 4px 10px 4px 0;
  }

  .resize-handle {
    position: absolute;
    top: 0;
    right: 0;
    z-index: 5;
    margin-right: -3px;
    cursor: col-resize;
    width: 6px;
    height: 100%;
  }
}

td {
  border-bottom: 1px solid $table-border-colour;

  // changing this 4px l/r padding requires a change in elm.
  // see TorrentTable widthAttribute methods
  padding: 3px 4px;

  div { // cell content to apply width style to
    overflow: hidden;
    white-space: nowrap;
  }
}
